<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>招贤纳士-社会招聘</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<script src="js/data.js"></script>
</head>
<body>
  <div id="wrap">
  	<div class="left">
    	<h2>招贤纳士</h2>
      <ul>
      	<!--<li class="focus"><a href="javascript:;">社会招聘</a></li>
      	<li><a href="javascript:;">校园招聘</a></li>-->
      </ul>
    </div>
  	<div class="right">
    	<div class="title">
      	<img src="img/shzp.gif" />
      </div>
      <div class="info">
      <!--<div> 
       <p class="zp">
        	<span><a href="">★ 职位需求：测试工程师【社会招聘】</a></span>
          <span>需求人数：2名</span>
         	<span class="date">2013年7月30日</span>
        </p>
      	<p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="">查看详情</a>]
        </p>
      </div>  

      	<p class="zp">
        	<span><a href="">★ 职位需求：测试工程师【社会招聘】</a></span>
          <span>需求人数：12名</span>
         	<span class="date">2013年7月30日</span>
        </p>
      	<p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="">查看详情</a>]
        </p>

      	<p class="zp">
        	<span><a href="">★ 职位需求：测试工程师【社会招聘】</a></span>
          <span>需求人数：21名</span>
         	<span class="date">2013年7月30日</span>
        </p>
      	<p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="">查看详情</a>]
        </p>-->

      </div>
      <div class="pages">
        <span class="prev">
          <a href="javascript:;">
            <img src="img/pre.gif">
          </a>
        </span>
        <span class="next">
          <a href="javascript:;">
            <img src="img/next.gif">
          </a>
        </span>
        <p class="num">
          <!--<span class="focus">
            <a href="javascript:;">1</a>
          </span>
          <span>
            <a href="javascript:;">2</a>
          </span>
          <span>
            <a href="javascript:;">3</a>
          </span>-->
        </p>
        
      </div>
      
    </div>
    <div class="clear"></div>
  </div>
<script type="text/javascript">
(function () {
//--------------------------------------------------------------
//var search = window.location.search.substr(1);
//根据lx值判断是哪个招聘
var lx = getVal('s') || 'sh';
console.log(lx);
//根据hash值生成页面内容 其实没有hash的时候则默认为1
var hash = window.location.hash.substr(3) || 1;
console.log(hash);
	
	
//---------------------------------------------------------------	
setLeft();	
setImg();
setRight(2 * (hash - 1));
setNav();
prevNext();
//-----------------------------------------------------------------

//一： 生成左侧列表
function setLeft() {
	var ul = document.querySelector('.left ul');
	var lis = ul.children;
	aData.list.forEach(function (item,i) {
		var li = document.createElement('li');
		var a = document.createElement('a');
		a.href = 'javascript:;';
		a.innerHTML = item.text;
		li.appendChild(a);
		li.onclick = function () {
			window.location.hash = 'p=1';
			hash = 1;
			window.location.search = 's='+ item.lx +'';
			
//			li.className = 'focus';
		};
		ul.appendChild(li);
	})
	
	//还原默认hash值
//	if ( search && lx == 'xy' ) {
//		lis[1].className = 'focus';
//		window.location.hash = 'p=1';
//		hash = 1;
//	} else {
//		lis[0].className = 'focus';
//		window.location.hash = 'p=1';
//		hash = 1;
//	}
	
	aData.list.forEach(function (item,i) {
		if (item.lx == lx) {
			lis[i].className = 'focus';
		}
	})
	
	
}

//二： 生成右侧列表
	//右侧图片
	function setImg() {
		var img = document.querySelector('.title img');
		img.src = aData[lx].img;
	}
	
	//右侧列表内容
	function setRight(num) {
		var info = document.querySelector('.info');
		var str = '';
		var data = aData[lx].text;
		for ( var i = num; i < num + 2; i++ ) {
			if ( data[i] ) {
				str += '<div><p class="zp"><span><a href="">★'+ data[i].zw +'</a></span><span>需求人数：'+ data[i].rs +'名</span><span class="date">2013年7月30日</span></p><p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="content.html?s='+lx+'#p='+(i+1)+'">查看详情</a>]</p></div>';
			}
			//content.html?s='+lx+'#p='+(i+1) 页面跳转的地址
		}
		info.innerHTML = str;
	}
	
	//生成下方导航
	function setNav() {
		var num = document.querySelector('.num');
		var as = num.getElementsByTagName('a');
		var spans = num.getElementsByTagName('span');
		
		for ( var i = 0; i < Math.ceil(aData[lx].text.length/2); i++ ) {
			var span = document.createElement('span');
			var a = document.createElement('a');
			a.href = 'javascript:;';
			a.innerHTML = i + 1;
			span.appendChild(a);
			num.appendChild(span);
		}
		
		for ( var i = 0; i < as.length; i++ ) {
			as[i].index = i;
			as[i].onclick = function () {
				window.location.hash = 'p='+ (this.index + 1) +'';
			}
		}
		spans[hash - 1].className = 'focus';
		window.onhashchange = function () {
			var hash = window.location.hash.substr(3) || 1;//重新获取hash值
			setRight(2 * (hash - 1));
			
			for (var i = 0; i < spans.length; i++ ) {
				spans[i].className = '';
			}
			spans[hash - 1].className = 'focus';
		}
	}

	//点击下一张 和上一张
	function prevNext() {
		var prev = document.querySelector('.prev');
		var next = document.querySelector('.next');
		var num = document.querySelector('.num');
		var as = num.getElementsByTagName('a');
		var spans = num.getElementsByTagName('span');
		console.log(as);

		next.onclick = function () {
			hash++;
			if ( hash > as.length) {
				hash = 1;
			}
//		setRight(2 * (hash - 1));
			window.location.hash = `p=${hash}`;
//			for (var i = 0; i < spans.length; i++ ) {
//				spans[i].className = '';
//			}
//			spans[hash - 1].className = 'focus';
		};
		
		prev.onclick = function () {
			hash--;
			if ( hash < 1) {
				hash = as.length;
			}
//		setRight(2 * (hash - 1));
			window.location.hash = `p=${hash}`;
//			for (var i = 0; i < spans.length; i++ ) {
//				spans[i].className = '';
//			}
//			spans[hash - 1].className = 'focus';
		};
		
		
	}


//封装获取search值的方法
function getVal( key ) {
	var search = window.location.search.substr(1);
	if (!search) {
		return;
	} 
	var val;
	
	if ( search.indexOf('&') != -1 ) {
		var arr = search.split('&');
		arr.forEach(function (item,i) {
			var arr = item.split('=');
			if ( key == arr[0] ) {
				val = arr[1];
			}
		})
	} else {
		var arr = search.split('=');
		if ( key == arr[0] ) {
			val = arr[1];
		}
	}
	return val;
	
}


})();
</script>
</body>
</html>
